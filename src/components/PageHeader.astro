---
import {
  Avatar,
} from 'accessible-astro-components';
import { Image } from 'astro:assets';
import { renderSafeContent } from '../utils/renderContent';

/**
 * PageHeader Component
 *
 * @description PageHeader description
 */
interface Props {

  class?: string;

  featuredImage?: string;

  title: string;
  /**
   * The subtitle of the page
   * @description Can contain HTML content (will be sanitized)
   */
  subtitle?: string;
  /**
   * The background color of the page header
   * @type {'primary' | 'secondary' | 'neutral' | 'gradient' | 'bordered' | undefined}
   * @default undefined - Uses the default background color
   */
  /**
   * The author of the page
   */
  author?: {
    name: string;
    image: string;
    bio: string;
  };
  bgType?: 'primary' | 'secondary' | 'neutral' | 'gradient' | 'bordered';
}

const {
  class: className,
  title,
  subtitle,
  bgType,
  featuredImage,
  author,
} = Astro.props;

// Sanitize subtitle HTML if present
const sanitizedSubtitle: string = subtitle
  ? renderSafeContent(subtitle)
  : '';
---

<section class:list={[className, 'page-header']}>
  <div class:list={['py-16', bgType && `bg-${bgType}`]}>
    <div class="container space-content">
      {
        featuredImage && (
          <div class="mb-8 featured-image-container">
            <Image
              src={featuredImage}
              alt=""
              width={1200}
              height={250}
              class="h-[250px] w-full rounded-lg object-cover"
            />
          </div>
        )
      }
      <h1>{title}</h1>
      {sanitizedSubtitle && <p class="text-2xl" set:html={sanitizedSubtitle} />}
      {
        author && (
          <div class="flex items-center mt-6">
            <Avatar
              title={author.name}
              image={author.image}
              subtitle={author.bio}
            />
          </div>
        )
      }
    </div>
  </div>
</section>

<style>
  .page-header {
    border-top: 1px solid var(--border-color-subtle);
    border-bottom: 1px solid var(--border-color-subtle);

    .bg-primary {
      background-color: light-dark(
        var(--color-primary-100),
        var(--color-primary-500)
      );
    }

    .bg-secondary {
      background-color: light-dark(
        var(--color-secondary-100),
        var(--color-secondary-500)
      );
    }

    .bg-neutral {
      background-color: light-dark(
        var(--color-neutral-300),
        var(--color-neutral-800)
      );
    }

    .bg-gradient {
      background-image: linear-gradient(
        315deg,
        light-dark(var(--color-primary-100), var(--color-secondary-100)) 25%,
        light-dark(var(--color-secondary-100), var(--color-primary-200))
      );
      color: var(--color-neutral-900);
    }

    .bg-bordered {
      border: 1px solid var(--border-color-subtle);
      border-inline: 0;
    }

    .featured-image-container {
      max-height: 500px;
      /* overflow: hidden; */
    }
  }
</style>
