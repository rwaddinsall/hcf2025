---
import { Image } from "astro:assets";
import heroGalleryImage from "@assets/images/projects/HeroGallery.jpg";

/**
 * Hero Gallery Component
 *
 * @description A component that displays the main hero gallery image with optimized loading and responsive design
 */

interface Props {
  /**
   * Alternative text for the hero gallery image
   */
  alt?: string;
  /**
   * Additional CSS classes to apply to the gallery container
   */
  class?: string;
  /**
   * Loading strategy for the image
   */
  loading?: "lazy" | "eager";
  /**
   * Image quality (0-100 or preset)
   */
  quality?: number | "low" | "mid" | "high" | "max";
}

const {
  alt = "Hopkins Creek Festival gallery showcase",
  class: className = "",
  loading = "eager",
  quality = "high",
} = Astro.props;
---

<section class={`hero-gallery ${className}`} aria-labelledby="gallery-heading">
  <div class="hero-gallery__container">
    <h2 id="gallery-heading" class="visually-hidden">Festival Gallery</h2>

    <div class="hero-gallery__image-wrapper">
      <Image
        src={heroGalleryImage}
        alt={alt}
        loading={loading}
        quality={quality}
        widths={[320, 640, 768, 1024, 1280, 1600]}
        sizes="(max-width: 768px) 100vw, (max-width: 1024px) 90vw, 1200px"
        class="hero-gallery__image"
        format="webp"
      />
    </div>
  </div>
</section>

<style lang="scss">
  @use "../assets/scss/base/mixins" as *;
  @use "../assets/scss/base/breakpoint" as *;

  // Screen reader utility using design system mixin
  .visually-hidden {
    @include sr-only;
  }

  .hero-gallery {
    padding: var(--space-lg) var(--space-md);

    &__container {
      max-width: var(--container-max-width);
      margin: 0 auto;
      width: 100%;
      padding-inline: var(--container-gutter);
    }

    &__image-wrapper {
      position: relative;
      border-radius: var(--radius-lg);
      overflow: hidden;
      box-shadow: var(--elevation-md);
      transition: var(--transition-smooth);
      background-color: var(--color-neutral-100);

      // Focus styles for accessibility
      &:focus-within {
        outline: 3px solid var(--color-primary-500);
        outline-offset: var(--space-xs);
        box-shadow: var(--elevation-lg);
      }

      // Hover effects
      &:hover {
        transform: translateY(calc(var(--space-xs) * -1));
        box-shadow: var(--elevation-lg);
      }

      @include bp(tablet-down) {
        border-radius: var(--radius-md);

        &:hover {
          transform: translateY(calc(var(--space-2xs) * -1));
        }
      }

      @include bp(mobile-down) {
        border-radius: var(--radius-sm);

        &:hover {
          transform: none;
          box-shadow: var(--elevation-sm);
        }
      }
    }

    &__image {
      width: 100%;
      height: auto;
      display: block;
      transition: var(--transition-smooth);

      // Ensure crisp rendering
      image-rendering: -webkit-optimize-contrast;
      image-rendering: crisp-edges;

      // Aspect ratio container for consistent layout
      aspect-ratio: 16 / 9;
      object-fit: cover;
      object-position: center;

      @include bp(tablet-down) {
        aspect-ratio: 4 / 3;
      }

      @include bp(mobile-down) {
        aspect-ratio: 3 / 2;
      }

      // Loading state using design system colors
      &[data-loading] {
        background: linear-gradient(
          90deg,
          var(--color-neutral-100) 25%,
          var(--color-neutral-200) 50%,
          var(--color-neutral-100) 75%
        );
        background-size: 200% 100%;
        animation: shimmer var(--duration-slow) infinite;
      }
    }
  }

  // Animations
  @keyframes shimmer {
    0% {
      background-position: -200% 0;
    }
    100% {
      background-position: 200% 0;
    }
  }

  // Reduced motion support
  @media (prefers-reduced-motion: reduce) {
    .hero-gallery__image-wrapper {
      transition: none;

      &:hover {
        transform: none;
      }
    }

    .hero-gallery__image {
      transition: none;

      &[data-loading] {
        animation: none;
      }
    }
  }

  // High contrast mode support
  @media (prefers-contrast: high) {
    .hero-gallery__image-wrapper {
      border: 2px solid var(--color-text-primary);
    }
  }

  // Dark mode support using design system
  @media (prefers-color-scheme: dark) {
    .hero-gallery__image-wrapper {
      background-color: var(--color-neutral-800);
      box-shadow: var(--elevation-dark-md);

      &:hover {
        box-shadow: var(--elevation-dark-lg);
      }

      &:focus-within {
        box-shadow: var(--elevation-dark-lg);
      }
    }
  }

  // Print styles
  @media print {
    .hero-gallery {
      break-inside: avoid;
      page-break-inside: avoid;
      padding: var(--space-md) 0;
    }

    .hero-gallery__image-wrapper {
      box-shadow: none;
      transform: none !important;
    }
  }

  // Large screens optimization
  @include bp(desktop-up) {
    .hero-gallery {
      padding: var(--space-xl) var(--space-lg);
    }

    .hero-gallery__image-wrapper {
      border-radius: var(--radius-xl);
    }
  }
</style>
